Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: pip in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (21.1.1)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: tensorflow in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (2.5.0)
Requirement already satisfied: grpcio~=1.34.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (1.34.1)
Requirement already satisfied: termcolor~=1.1.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (1.1.0)
Requirement already satisfied: absl-py~=0.10 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (0.12.0)
Requirement already satisfied: opt-einsum~=3.3.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (3.3.0)
Requirement already satisfied: wheel~=0.35 in /afs/crc.nd.edu/x86_64_linux/c/conda/miniconda3/4.9.2/lib/python3.8/site-packages (from tensorflow) (0.35.1)
Requirement already satisfied: h5py~=3.1.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (3.1.0)
Requirement already satisfied: six~=1.15.0 in /afs/crc.nd.edu/x86_64_linux/c/conda/miniconda3/4.9.2/lib/python3.8/site-packages (from tensorflow) (1.15.0)
Requirement already satisfied: tensorboard~=2.5 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (2.5.0)
Requirement already satisfied: tensorflow-estimator<2.6.0,>=2.5.0rc0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (2.5.0)
Requirement already satisfied: typing-extensions~=3.7.4 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (3.7.4.3)
Requirement already satisfied: keras-preprocessing~=1.1.2 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (1.1.2)
Requirement already satisfied: keras-nightly~=2.5.0.dev in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (2.5.0.dev2021032900)
Requirement already satisfied: numpy~=1.19.2 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (1.19.5)
Requirement already satisfied: flatbuffers~=1.12.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (1.12)
Requirement already satisfied: astunparse~=1.6.3 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (1.6.3)
Requirement already satisfied: wrapt~=1.12.1 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (1.12.1)
Requirement already satisfied: gast==0.4.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (0.4.0)
Requirement already satisfied: protobuf>=3.9.2 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (3.17.0)
Requirement already satisfied: google-pasta~=0.2 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorflow) (0.2.0)
Requirement already satisfied: google-auth<2,>=1.6.3 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorboard~=2.5->tensorflow) (1.30.0)
Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorboard~=2.5->tensorflow) (0.6.1)
Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorboard~=2.5->tensorflow) (0.4.4)
Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorboard~=2.5->tensorflow) (1.8.0)
Requirement already satisfied: werkzeug>=0.11.15 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorboard~=2.5->tensorflow) (2.0.0)
Requirement already satisfied: markdown>=2.6.8 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from tensorboard~=2.5->tensorflow) (3.3.4)
Requirement already satisfied: setuptools>=41.0.0 in /afs/crc.nd.edu/x86_64_linux/c/conda/miniconda3/4.9.2/lib/python3.8/site-packages (from tensorboard~=2.5->tensorflow) (50.3.1.post20201107)
Requirement already satisfied: requests<3,>=2.21.0 in /afs/crc.nd.edu/x86_64_linux/c/conda/miniconda3/4.9.2/lib/python3.8/site-packages (from tensorboard~=2.5->tensorflow) (2.24.0)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from google-auth<2,>=1.6.3->tensorboard~=2.5->tensorflow) (0.2.8)
Requirement already satisfied: cachetools<5.0,>=2.0.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from google-auth<2,>=1.6.3->tensorboard~=2.5->tensorflow) (4.2.2)
Requirement already satisfied: rsa<5,>=3.1.4 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from google-auth<2,>=1.6.3->tensorboard~=2.5->tensorflow) (4.7.2)
Requirement already satisfied: requests-oauthlib>=0.7.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard~=2.5->tensorflow) (1.3.0)
Requirement already satisfied: pyasn1<0.5.0,>=0.4.6 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from pyasn1-modules>=0.2.1->google-auth<2,>=1.6.3->tensorboard~=2.5->tensorflow) (0.4.8)
Requirement already satisfied: certifi>=2017.4.17 in /afs/crc.nd.edu/x86_64_linux/c/conda/miniconda3/4.9.2/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard~=2.5->tensorflow) (2020.6.20)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /afs/crc.nd.edu/x86_64_linux/c/conda/miniconda3/4.9.2/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard~=2.5->tensorflow) (1.25.11)
Requirement already satisfied: chardet<4,>=3.0.2 in /afs/crc.nd.edu/x86_64_linux/c/conda/miniconda3/4.9.2/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard~=2.5->tensorflow) (3.0.4)
Requirement already satisfied: idna<3,>=2.5 in /afs/crc.nd.edu/x86_64_linux/c/conda/miniconda3/4.9.2/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard~=2.5->tensorflow) (2.10)
Requirement already satisfied: oauthlib>=3.0.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard~=2.5->tensorflow) (3.1.0)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: opencv-python in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (4.5.1.48)
Requirement already satisfied: numpy>=1.17.3 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from opencv-python) (1.19.5)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: scikit-learn in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (0.24.2)
Requirement already satisfied: numpy>=1.13.3 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from scikit-learn) (1.19.5)
Requirement already satisfied: joblib>=0.11 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from scikit-learn) (1.0.1)
Requirement already satisfied: threadpoolctl>=2.0.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from scikit-learn) (2.1.0)
Requirement already satisfied: scipy>=0.19.1 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from scikit-learn) (1.6.3)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: matplotlib in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (3.4.2)
Requirement already satisfied: python-dateutil>=2.7 in /afs/crc.nd.edu/x86_64_linux/c/conda/miniconda3/4.9.2/lib/python3.8/site-packages (from matplotlib) (2.8.1)
Requirement already satisfied: cycler>=0.10 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from matplotlib) (0.10.0)
Requirement already satisfied: pyparsing>=2.2.1 in /afs/crc.nd.edu/x86_64_linux/c/conda/miniconda3/4.9.2/lib/python3.8/site-packages (from matplotlib) (2.4.7)
Requirement already satisfied: kiwisolver>=1.0.1 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from matplotlib) (1.3.1)
Requirement already satisfied: numpy>=1.16 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from matplotlib) (1.19.5)
Requirement already satisfied: pillow>=6.2.0 in /afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages (from matplotlib) (8.2.0)
Requirement already satisfied: six in /afs/crc.nd.edu/x86_64_linux/c/conda/miniconda3/4.9.2/lib/python3.8/site-packages (from cycler>=0.10->matplotlib) (1.15.0)
2021-05-17 23:50:09.970021: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/crc/usr/local/lib
2021-05-17 23:50:09.970100: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2021-05-17 23:55:35.924878: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2021-05-17 23:55:36.147544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.582GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2021-05-17 23:55:36.149505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 1 with properties: 
pciBusID: 0000:83:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.582GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2021-05-17 23:55:36.160876: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/crc/usr/local/lib
2021-05-17 23:55:36.161169: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcublas.so.11'; dlerror: libcublas.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/crc/usr/local/lib
2021-05-17 23:55:36.161411: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcublasLt.so.11'; dlerror: libcublasLt.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/crc/usr/local/lib
2021-05-17 23:55:36.161683: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/crc/usr/local/lib
2021-05-17 23:55:36.161926: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/crc/usr/local/lib
2021-05-17 23:55:36.173252: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusolver.so.11'; dlerror: libcusolver.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/crc/usr/local/lib
2021-05-17 23:55:36.173565: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcusparse.so.11'; dlerror: libcusparse.so.11: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/crc/usr/local/lib
2021-05-17 23:55:36.173811: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/crc/usr/local/lib
2021-05-17 23:55:36.173863: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1766] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-05-17 23:55:36.190261: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-05-17 23:55:36.192877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-17 23:55:36.192929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      
500
1000
1500
2000
2500
3000
3500
4000
4500
5000
5500
6000
(63920, 227, 227, 3) (227, 227, 3)
(63920, 11)
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 227, 227, 16)      2368      
_________________________________________________________________
batch_normalization (BatchNo (None, 227, 227, 16)      64        
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 113, 113, 16)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 113, 113, 16)      12560     
_________________________________________________________________
batch_normalization_1 (Batch (None, 113, 113, 16)      64        
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 56, 56, 16)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 56, 56, 32)        12832     
_________________________________________________________________
batch_normalization_2 (Batch (None, 56, 56, 32)        128       
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 28, 28, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 28, 28, 64)        51264     
_________________________________________________________________
batch_normalization_3 (Batch (None, 28, 28, 64)        256       
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 14, 14, 64)        0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 14, 14, 128)       73856     
_________________________________________________________________
batch_normalization_4 (Batch (None, 14, 14, 128)       512       
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 7, 7, 128)         0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 7, 7, 256)         295168    
_________________________________________________________________
batch_normalization_5 (Batch (None, 7, 7, 256)         1024      
_________________________________________________________________
max_pooling2d_5 (MaxPooling2 (None, 2, 2, 256)         0         
_________________________________________________________________
average_pooling2d (AveragePo (None, 1, 1, 256)         0         
_________________________________________________________________
flatten (Flatten)            (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 128)               32896     
_________________________________________________________________
dropout (Dropout)            (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 32)                4128      
_________________________________________________________________
dropout_1 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 11)                363       
=================================================================
Total params: 487,483
Trainable params: 486,459
Non-trainable params: 1,024
_________________________________________________________________
None
-TRAINING----------------------------
Traceback (most recent call last):
  File "train.py", line 85, in <module>
    x_train, x_valid, y_train, y_valid = train_test_split(X, Y, train_size=0.8,test_size=0.2, shuffle= True)
  File "/afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages/sklearn/model_selection/_split.py", line 2199, in train_test_split
    return list(chain.from_iterable((_safe_indexing(a, train),
  File "/afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages/sklearn/model_selection/_split.py", line 2199, in <genexpr>
    return list(chain.from_iterable((_safe_indexing(a, train),
  File "/afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages/sklearn/utils/__init__.py", line 344, in _safe_indexing
    return _array_indexing(X, indices, indices_dtype, axis=axis)
  File "/afs/crc.nd.edu/user/k/kborisia/.local/lib/python3.8/site-packages/sklearn/utils/__init__.py", line 179, in _array_indexing
    return array[key] if axis == 0 else array[:, key]
numpy.core._exceptions.MemoryError: Unable to allocate 29.4 GiB for an array with shape (51136, 227, 227, 3) and data type float32
